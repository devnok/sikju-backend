# Migration `20200417152208`

This migration has been generated by devnok at 4/17/2020, 3:22:08 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."AccountLink.facebookId"

DROP INDEX "public"."AccountLink.kakaoId"

ALTER TABLE "public"."AccountLink" DROP COLUMN "facebookId",
DROP COLUMN "kakaoId",
ADD COLUMN "id" text  NOT NULL ,
ADD COLUMN "provider" "Provider" NOT NULL ,
ADD COLUMN "token" text  NOT NULL ;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200417145711..20200417152208
--- datamodel.dml
+++ datamodel.dml
@@ -3,16 +3,18 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model AccountLink {
-  facebookId String? @unique
-  kakaoId    String? @unique
+  provider Provider
+  token String
+  id String
   userId     String  @unique
   user       User    @relation(fields: [userId], references: [id])
+  @@id([provider, id])
 }
 model Coupon {
   createdAt DateTime @default(now())
@@ -98,9 +100,9 @@
   createdAt   DateTime     @default(now())
   id          String       @id
   nickname    String       @unique
   phone       String       @unique
-  AccountLink AccountLink?
+  AccountLink AccountLink[]
   Coupon      Coupon[]
   Like        Like[]
   Profile     Profile
 }
```


