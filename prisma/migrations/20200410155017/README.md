# Migration `20200410155017`

This migration has been generated by devnok at 4/10/2020, 3:50:17 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER INDEX "public"."AccountLink_userId" RENAME TO "AccountLink.userId"

ALTER INDEX "public"."Location_restId" RENAME TO "Location.restId"

ALTER INDEX "public"."Profile_userId" RENAME TO "Profile.userId"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200410154524..20200410155017
--- datamodel.dml
+++ datamodel.dml
@@ -1,105 +1,113 @@
-// This is your Prisma schema file,
-// learn more about it in the docs: https://pris.ly/d/prisma-schema
+generator client {
+  provider = "prisma-client-js"
+}
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
-generator client {
-  provider = "prisma-client-js"
+model AccountLink {
+  facebookId String @unique
+  id         Int    @default(autoincrement()) @id
+  kakaoId    String @unique
+  userId     Int    @unique
+  User       User   @relation(fields: [userId], references: [id])
 }
-enum Gender{
-  MALE
-  FEMALE
+model Coupon {
+  createdAt DateTime @default(now())
+  desc      String
+  expireAt  DateTime
+  id        Int      @default(autoincrement()) @id
+  restId    Int
+  servcie   String
+  startAt   DateTime
+  userId    Int
+  warn      String
+  Rest      Rest     @relation(fields: [restId], references: [id])
+  User      User     @relation(fields: [userId], references: [id])
 }
-model User{
-  id Int @id @default(autoincrement())
-  nickname String @unique
-  phone String @unique
-  profile Profile
-  link AccountLink?
-  coupons Coupon[]
-  likes Like[]
+
+model Event {
   createdAt DateTime @default(now())
-}
-model Profile{
-  id Int @id @default(autoincrement())
-  name String?
-  birthday DateTime?
-  gender Gender? @default(MALE)
-  email String? @unique
-  user User @relation(fields: [userId], references: [id])
-  userId Int
-}
-model AccountLink{
-  id Int @id @default(autoincrement())
-  user User @relation(fields: [userId], references: [id])
-  userId Int
-  kakaoId String @unique
-  facebookId String @unique
-}
-model Rest{
-  id Int @id @default(autoincrement())
-  location Location
-  name String
-  phone String
-  desc String
-  openAt DateTime?
-  closeAt DateTime?
-  coupons Coupon[]
-  files File[] @relation("FilesOnRest")
+  expireAt  DateTime
+  id        Int      @default(autoincrement()) @id
+  startAt   DateTime
   thumbnail String
-  service Service
-  likes Like[]
+  url       String   @unique
 }
-model File{
-  id Int @id @default(autoincrement())
-  url String
-  rest Rest @relation("FilesOnRest", fields: [restId], references: [id])
+
+model File {
+  id     Int    @default(autoincrement()) @id
   restId Int
+  url    String
+  Rest   Rest   @relation(fields: [restId], references: [id])
 }
-model Service{
-  rest Rest @relation(fields: [restId], references: [id])
-  restId Int @unique
-  service String
-  desc String
-  warn String?
-  validTime Int @default(168)
-}
-model Coupon{
-  id Int @id @default(autoincrement())
-  rest Rest @relation(fields: [restId], references: [id])
+
+model Like {
+  id     Int  @default(autoincrement()) @id
   restId Int
-  servcie String
-  desc String
-  warn String
-  user User @relation(fields: [userId], references: [id])
   userId Int
-  createdAt DateTime @default(now())
-  startAt DateTime
-  expireAt DateTime
+  Rest   Rest @relation(fields: [restId], references: [id])
+  User   User @relation(fields: [userId], references: [id])
 }
-model Location{
-  rest Rest @relation(fields: [restId], references: [id])
-  restId Int
+
+model Location {
+  latitude  Float
   longitude Float
-  latitude Float
-  @@unique([latitude, longitude])
+  restId    Int   @unique
+  Rest      Rest  @relation(fields: [restId], references: [id])
+
+  @@unique([latitude, longitude], name: "Location.latitude_longitude")
 }
-model Like{
-  id Int @id @default(autoincrement())
-  user User @relation(fields: [userId], references: [id])
-  userId Int
-  rest Rest @relation(fields: [restId], references: [id])
-  restId Int
+
+model Profile {
+  birthday DateTime?
+  email    String?   @unique
+  gender   Gender?   @default(dbgenerated())
+  id       Int       @default(autoincrement()) @id
+  name     String?
+  userId   Int       @unique
+  User     User      @relation(fields: [userId], references: [id])
 }
-model Event {
-  id Int @id @default(autoincrement())
-  url String @unique
+
+model Rest {
+  closeAt   DateTime?
+  desc      String
+  id        Int       @default(autoincrement()) @id
+  name      String
+  openAt    DateTime?
+  phone     String
   thumbnail String
-  createdAt DateTime @default(now())
-  startAt DateTime
-  expireAt DateTime
+  Coupon    Coupon[]
+  File      File[]
+  Like      Like[]
+  Location  Location?
+  Service   Service?
+}
+
+model Service {
+  desc      String
+  restId    Int     @unique
+  service   String
+  validTime Int     @default(168)
+  warn      String?
+  Rest      Rest    @relation(fields: [restId], references: [id])
+}
+
+model User {
+  createdAt   DateTime     @default(now())
+  id          Int          @default(autoincrement()) @id
+  nickname    String       @unique
+  phone       String       @unique
+  AccountLink AccountLink?
+  Coupon      Coupon[]
+  Like        Like[]
+  Profile     Profile?
+}
+
+enum Gender {
+  FEMALE
+  MALE
 }
```


